# vim:tw=200
---
# Note: Won't work without Node (which means homebrew role has to have run
# first, but I don't want to declare an explicit, heavyweight dependency in this
# role).
- name: install global yarn modules
  yarn: name={{ item }} global=yes
  loop:
    - prettier
    - vercel
    - svgo
    - reason-cli@latest-macos
    - bash-language-server
    - dockerfile-language-server-nodejs
    - ocaml-language-server
    - typescript-language-server
    - yaml-language-server
    - vim-language-server
    - vscode-css-languageserver-bin
    - vscode-json-languageserver

- name: install global python packages
  pip:
    executable=pip3 name={{ item }} extra_args={{ '--user' if item == 'pip' else
    '--upgrade' }}
  loop:
    - setuptools
    - pip
    - websocket-client
    - black
    - pylint
    - tuir
    # for mutt & dump-ical.py script
    - vobject

- name: install rust
  shell:
    CARGO_HOME="${XDG_DATA_HOME:-$HOME/.local/share}/cargo" curl --proto
    '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --no-modify-path
    && ~/.local/share/cargo/bin/rustup component add rls rust-analysis rust-src
  ignore_errors: yes
