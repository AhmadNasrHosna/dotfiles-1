# {{ ansible_managed }}

defaults
port 587
protocol smtp
auth on
tls on
tls_trust_file /usr/local/etc/openssl/cert.pem
{% for account in mail_accounts %}
{% if account.smtp_user != '' %}
account {{ account.name | lower }}
host {{ account.smtp_server }}
from {{ account.smtp_from }}
user {{ account.smtp_user }}
passwordeval ~/.config/zsh/bin/get-keychain-pass {{ account.smtp_keychain_account }} {{ account.smtp_keychain_name }}

{% endif %}
{% endfor %}

account default : {{ 'work' if 'work' in group_names else 'personal' }}
